<%@ page language="java" import="java.util.*" pageEncoding="UTF-8"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c" %>

<!DOCTYPE html>
<html>
<head>
	<title>试题列表</title>
	<link rel="stylesheet" href="<%=request.getContextPath()%>/css/main.css" />
	<link rel="stylesheet" href="<%=request.getContextPath()%>/plugins/layui/css/layui.css" />
	<script type="text/javascript" src="<%=request.getContextPath()%>/plugins/layui/layui.js"></script>
	<script type="text/javascript" src="<%=request.getContextPath()%>/js/jquery-1.8.3.js"></script>
	<script type="text/javascript">
		$(function(){
			$("#page button").click(function(){
				var name = $(this).attr("name");
		    	var currPageNo = parseInt($("#currPageNo").val());
		    	if(name == "home"){
		    		currPageNo = 1;
		    	}
		    	if(name == "prev"){
		    		currPageNo += -1; 
		    	}
		    	if(name == "next"){
		    		currPageNo += 1;
		    	}
		    	if(name == "last"){
		    		currPageNo = $("#totalPageCount").val();
		    	}
		    	if(name == "ok"){
		    		if($("#num").val() % 1 != 0){return;}
		    		currPageNo = $("#num").val();
		    	}
		    	$("#currPageNo").val(currPageNo);
		    	$("#myForm").submit();
			});
		});
	</script>
</head>

<body>
	<form action="topicList.do" method="post" id="myForm">
	
		<div class="layui-form-item" style="margin-top:20px;">
			<div class="layui-inline">
				<label class="layui-form-label">试题名称：</label>
				<div class="layui-input-inline">
					<input type="text" class="layui-input" name="name" value="${topic.name }">
				</div>
			</div>
			<div class="layui-inline">
				<label class="layui-form-label">试题级别：</label>
				<select class="select" name="level">
					<option value="0" <c:if test="${topic.level==null }">selected="selected"</c:if>>请选择级别</option>
					<option <c:if test="${topic.level=='A' }">selected="selected"</c:if>>A</option>
					<option <c:if test="${topic.level=='B' }">selected="selected"</c:if>>B</option>
					<option <c:if test="${topic.level=='C' }">selected="selected"</c:if>>C</option>
				</select>
			</div>
			<div class="layui-inline">
				<label class="layui-form-label">所属部门：</label>
				<select class="select" name="dept.id">
					<option value="0">请选择部门</option>
					<c:forEach var="dept" items="${deptList }">
						<option value="${dept.id }" <c:if test="${topic.dept.id==dept.id }">selected="selected"</c:if>>${dept.name }</option>
					</c:forEach>
				</select>
			</div>
			<input type="submit" class="layui-btn layui-btn-radius" style="margin-top:-5px;" value="查&nbsp;询" />
			<a class="layui-btn layui-btn-radius" style="margin-top:-5px;" href="topicAdd.do?res=1">新&nbsp;增&nbsp;试&nbsp;题</a>
		</div>
		
		<div class="layui-field-box layui-form">
			<table class="layui-table admin-table">
				<thead>
					<tr>
						<th>试题名称</th>
						<th>试题类型</th>
						<th>试题级别</th>
						<th>所属部门</th>
						<th style="width:200px;">操作</th>
					</tr>
				</thead>
				<c:forEach var="topic" items="${page.pageList }">
					<tr>
						<td>${topic.name }</td>
						<td>${topic.type }</td>
						<td>${topic.level }</td>
						<td>${topic.dept.name }</td>
						<td><a href="topicUpd.do?id=${topic.id }&res=1" class="layui-btn layui-btn-normal layui-btn-mini">修改</a>
							<a href="topicDetail.do?id=${topic.id }" class="layui-btn layui-btn-mini">详情</a>
							<a href="topicDel.do?id=${topic.id }" class="layui-btn layui-btn-danger layui-btn-mini">删除</a>
						</td>
					</tr>
				</c:forEach>
			</table>
			<p style="width:100px;margin:0px auto;margin-top:30px;color:red;">${msg}</p>
		</div>
	
		<div id="page" class="btable-paged" data-type="paged" style="margin:20px auto;width:550px;">
			<input type="hidden" id="currPageNo" value="${page.currPageNo}" name="currPageNo">
			<input type="hidden" id="totalPageCount" value="${page.pageTotalCount}">
			<div class="layui-box layui-laypage layui-laypage-default">
				<span class="layui-laypage-total">
					<button name="home">首页</button>
					<button name="prev">上一页</button>
					<span>${page.currPageNo } / ${page.pageTotalCount }</span>
					<button name="next">下一页</button>
					<button name="last">尾页</button>
					到第 <input class="layui-laypage-skip" type="number" id="num"> 页
					<button name="ok">确定</button>
				</span>
			</div>
		</div>

	</form>
</body>
</html>
